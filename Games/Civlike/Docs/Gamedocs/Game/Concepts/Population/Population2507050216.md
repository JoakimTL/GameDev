# Population, Demographics & City Simulation
## 1 · Scope & Pillar Links
This specification describes how human population is simulated from **10 000 BC** through **2050 AD +** and how the system integrates with _Culture_, _Trade & Market_, _Technology_, _Buildings & Recipes_ and _Laws_.
- **Data‑light:** individuals are never stored; instead, aggregated **cohorts** scale to **≈ 15 billion** people without heavy memory use.
- **Deep cross‑links:** mechanics cite the other pillar docs via numeric footnotes for one‑click access.

---
## 2 · Core Data Model
Each **Population Centre** owns a sparse array of **PopCohort** records keyed by _Age, CultureId, Sex, Phenotype, EducationTier, Vocation_.
```
struct PopCohort
{
    byte    Age;            // 0‑99; 100+ ⇒ automatic death
    ushort  CultureId;      // leaf‑culture reference
    Sex     Sex;            // 0=Male, 1=Female, 2=Other
    ushort  PhenotypeId;    // EAR phenotype enum
    byte    EducationTier;  // 0‑32 years bucketed
    ushort  VocationId;     // 0 if unemployed

    uint    Count;          // # people in cohort
    float   AvgHealth;      // 0‑1
    float   AvgWageOffer;   // cached from last labour pass
}
```
No cohort merging is needed; one record already covers _all_ matching people—late‑game cohorts often represent 100 000 + citizens.

---
## 3 · Simulation Tick Cadence

|Era|Span (y)|**Ticks / y**|Total ticks|
|---|---|---|---|
|10 000 – 4 000 BC|6 000|1|6 000|
|4 000 – 2 000 BC|2 000|2|4 000|
|2 000 BC – 0 AD|2 000|4|8 000|
|0 – 750 AD|750|12|9 000|
|750 – 1 500 AD|750|52|39 000|
|1 500 – 1 800 AD|300|365|109 500|
|1 800 – 1 900 AD|100|1 460|146 000|
|1 900 – 2 050 AD|150|8 760|1 314 000|
|**TOTAL**|12 050|—|**1 635 500**|
At **max speed (10 ticks·s⁻¹)** a full run lasts **≈ 45 h**. Players can throttle to 2‑5 t/s for late‑game readability.

---
## 4 · Annual Update Loop
During each _sim‑year_ (many real ticks once the calendar becomes fine‑grained) every centre executes:
1. **Births & Deaths** – UN baseline curves × fertility/mortality modifiers (nutrition, disease, contraception, family‑planning laws ).
2. **Ageing** – `Age++`; cohorts at `Age==100` die.
3. **Health & Disease** – health average adjusted; epidemics applied .
4. **Migration** – emigration/immigration step (§6).
5. **Labour & Education** – job matching, wage discovery, self‑study tick, school progress.
6. **Housing** – rent allocation → homelessness / crowding update (feeds unrest §10).
7. **Unrest & Happiness** – recompute city‑level metrics.
8. **Manpower Pool** – eligible headcount cached for the military system .

---
## 5 · Fertility & Mortality
Baseline curves use historical UN data.
```
Fertility = Base × Nutrition × (1‑Disease) × (1‑ContraceptionUse) × LawFactor[^5]
Mortality = Base × (1+Disease) × (1‑TechMedicine) × CrowdFactor
```
All factors live in assets (Food, Disease, Technology, Laws); no hard‑coding.

---
## 6 · Migration
### 6.1 Utility Formula
For cohort → destination **D**:
```
U_D = wageExpectation^α · employmentChance^β · (1/housingCost)^γ · culturalAffinity^δ
```
- **Defaults:** α 0 .40 | β 0 .30 | γ 0 .20 | δ 0 .10 (sum = 1).
- **Cultural aspects:** each aspect may add
    ```
    "migrationModifiers": { "alpha": +0.05, "beta": 0, "gamma": -0.03, "delta": -0.02 }
    ```
    Additive; negatives are clamped and the weights are re‑normalised.
### 6.2 Flow
1. Compute utility for origin and reachable destinations.
2. **Potential movers** = `UnemploymentRatio × MigrationOpennessLaw`.
3. Distribute movers ∝ `(U_D – U_O)+`.

---
## 7 · Labour Market & Wage Formation
Every tick, buildings post `(vocationId, vacancies_i, wageBid_i)`.
```
demand   = Σ vacancies_i(v)
supply   = Σ unemployedCohorts(v)
scarcity = (demand / supply)^σ        // σ = 0.75
fairness = LivingWageIndex · ξ[^6]    // ξ = 0.25
wage*    = max(scarcity, fairness)
wage     = clamp(wage*, minWageLaw × unionMult, ∞)[^6]
```
Cohorts refuse jobs below `fairness` and may retrain or migrate.

---
## 8 · Housing & Crowding

|   |   |   |
|---|---|---|
|Symbol|Meaning|Default|
|**Capacity**|Units provided by Housing buildings|see _Buildings_|
|**RentTier**|Price band per unit|asset‑defined|
|**housingSpendRatio**|Wage fraction that may be spent on housing|0 .30 (culture default)|
Cohorts rent the cheapest units they can afford; overflow becomes **homeless**. _No room‑sharing._ Unrest penalty rises exponentially after the first homeless citizen and becomes severe past ≈ 10 % homelessness.

---
## 9 · Education
- **At‑home study:** progress = `0.25 year / sim‑year`; consumes parent labour.
- **School building:** faster progress; rate scales with building _Quality_ and teacher coverage .
- **Vocation gate:** every Vocation asset may declare `minEducationYears`.

---
## 10 · Unrest & Happiness
- **Unrest %** = citizens willing to disrupt (strikes → protests → revolt).
- **Happiness** dampens stress‑to‑unrest conversion.
```
unrest += Σ stress_i × (1 – happiness)
unrest  = clamp(0, unrest, 100)
```

---
## 11 · Manpower & Conscription
`ManpowerPool = Σ eligibleCohorts × DraftRateLaw × CultureExemptions` . The military system draws from this pool and returns veterans to labour cohorts.

---
## 12 · Performance & Modding Hooks
- **Soft cap:** 15 billion concurrent humans.
- All tunables are in assets (Vocation, Building, Tech, Food, Law, Cultural Aspect); balance mods require no code edits.
- Load‑time validation enforces α+β+γ+δ = 1 and `housingSpendRatio ∈ [0,1]`.

---
## Footnotes
**[1]** _Technology2507041317.md_ §3 “Medicine” & _Resources2507041320.md_ §“Medical Herbs” describe disease modifiers.  
**[2]** _BuildingsAndRecipes2507041609.md_ §9 “Housing” lists capacity and rent tiers.  
**[3]** _Laws2507042124.md_ §4 “Conscription” defines draft rates & exemptions.  
**[4]** _Culture2506271137.md_ explains cultural aspects and their `migrationModifiers`.  
**[5]** _Laws2507042124.md_ §2 “Family Planning & Reproductive Rights” governs fertility.  
**[6]** _Laws2507042124.md_ §3 “Labour & Wages” sets minimum wage, unions & living-wage index.  
**[7]** _BuildingsAndRecipes2507041609.md_ §4 “Education Buildings” details School specs.